# Дистрибутивы
Для курса "Наука о данных и аналитика больших объемов информации" мы планируем 2 дистрибутива
1) Дистрибутив сбора данных (v1 и v2)
2) Дистрибутив обработки данных

## Дистрибутив сбора данных(v1)
Данный дистрибутив был использован для сбора данных, однако не поддерживает горизонтальную масштабируемость. Его задача - заполнить уже установленный PostgreSQL данными из Habr.

Данный дистрибутив имеет 2 bat файла - "start.bat" и "install.bat".
При запуске install.bat установятся все необходимые requirements для Python и создатся база данных в PostgreSQL.
При запуске start.bat запустится наполнение PostgreSQL.

## Дистрибутив сбора данных(v2)
Так как сбор данных является самой затратной по времени частью, мы предоставляем все необходимые модули для сбора данных, обернутые в Docker-контейнеры.
Таким образом, появляется возможность запускать эти контейнеры на разных устройствах, что дает "горизонтальное масштабирование".

Предоставляемые модули:
1) Управляющий модуль (control)
2) Рабочий модуль (worker)

### Управляющий модуль (control)
Данный модуль должен быть запущен только на 1 компьютере. Его задача - посылать запросы рабочим модулям и сохранять данные, полученные с рабочих модулей. 

Данный модуль состоит из 3х контейнеров:

1) Database container - содержит в себе базу данных PostreSQL
2) Message broker container - содержит в себе RabbitMQ, для передачи данных между рабочими модулями
3) Control container - содержит в себе скрипт на Python, который организует работу рабочих модулей

Алгоритм работы данного модуля
1) Заполнить RabbitMQ задачами по получению списка пользователей из запросов поиска
2) Заполнить RabbitMQ задачами по получению информации по постам
3) Если с RabbitMQ сервера пришел список пользователей - объединить его с уже сохраненным и сохранить новый список.
4) Если с RabbitMQ сервера пришла информация о постах - сохранить эту информацию в БД, и из всех упомянутых пользователей составить список. Получившийся список объединить с уже сохраненным, по аналогии с п3
5) Дождаться опустошения списка задач
6) По имеющейся информации собрать список логинов пользователей
7) Заполнить RabbitMQ задачами по получению информации о пользователях
8) Если с RabbitMQ сервера пришла информация о пользователе - сохранить эту информацию в БД
9) Дождаться опустошения списка задач
10) Создать дамп базы данных и пользователей
11) Закрыть контейнеры и завершить работу

### Рабочий модуль (worker)
Данный модуль может быть запущен на любом числе компьютеров. Его задача - взаимодействие с Habr, по командам полученным от управляющего модуля.

Данный модуль состоит из 1 контейнера:

3) Worker container - содержит в себе скрипт на Python, который выполняет работу

Алгоритм работы данного модуля
1) Если RabbitMQ сервер недоступен - закрыть контейнер
2) Если с RabbitMQ сервера пришла задача по получению списка пользователей из запроса поиска - провести запрос, и полученную информацию отправить обратно на управляющий модуль.
3) Если с RabbitMQ сервера пришла задача по получению информации по посту - провести запрос, и полученную информацию отправить обратно на управляющий модуль.
4) Если с RabbitMQ сервера пришла задача по получению информации о пользователе - провести запрос, и полученную информацию отправить обратно на управляющий модуль.

### Итог
В результате работы данных модулей мы получим дамп базы данных, который может быть скопирован в "Дистрибутив обработки данных" для дальнейшей работы.

## Дистрибутив обработки данных
В связи с относительно небольшим объемом обрабатываемых данных, данный модуль не поддерживает горизонтальную масштабируемость. Он состоит из 2х контейнеров: 
1) Database container - содержит в себе базу данных PostreSQL
2) Server container - содержит в себе сервер для отображения обработанной информации

